<!--
  ~ Copyright (c) 2008-2013 Haulmont. All rights reserved.
  ~ Use is subject to license terms, see http://www.cuba-platform.com/license for details.
  -->

<window xmlns="http://schemas.haulmont.com/cuba/5.2/window.xsd"
        class="com.haulmont.cuba.gui.app.core.scheduled.ScheduledTaskEditor"
        messagesPack="com.haulmont.cuba.gui.app.core.scheduled"
        datasource="taskDs"
        caption="msg://taskEditCaption">

    <dsContext>
        <datasource id="taskDs" class="com.haulmont.cuba.core.entity.ScheduledTask" view="_local"/>
    </dsContext>

    <assign name="fieldWidth" value="theme://cuba.gui.scheduled-task-edit.field.width"/>
    <assign name="smallFieldWidth" value="theme://cuba.gui.scheduled-task-edit.smallField.width"/>

    <layout expand="gridScroll" spacing="true">
        <scrollBox id="gridScroll" scrollBars="both">
            <grid id="grid" spacing="true">
                <columns count="3"/>
                <rows>
                    <row>
                        <label value="msg://com.haulmont.cuba.core.entity/ScheduledTask.definedBy" align="MIDDLE_LEFT"/>
                        <optionsGroup id="definedByField" datasource="taskDs" property="definedBy"
                                      width="${smallFieldWidth}"
                                      required="true" multiselect="false" orientation="horizontal"/>
                        <label value=""/> <!-- temporary workaround until #PL-1701 is fixed -->
                    </row>
                    <row>
                        <label id="beanNameLabel" value="msg://com.haulmont.cuba.core.entity/ScheduledTask.beanName"
                               align="MIDDLE_LEFT"/>
                        <lookupField id="beanNameField" datasource="taskDs" property="beanName" width="${fieldWidth}"
                                     required="true"/>
                        <label value=""/>
                    </row>
                    <row>
                        <label id="methodNameLabel"
                               value="msg://com.haulmont.cuba.core.entity/ScheduledTask.methodName" align="MIDDLE_LEFT"/>
                        <lookupField id="methodNameField" width="${fieldWidth}" captionProperty="methodSignature"
                                     required="true" align="MIDDLE_LEFT" requiredMessage="msg://validation.methodNameMissing"/>
                        <groupBox id="methodParamsBox" caption="msg://methodParams" width="${fieldWidth}">
                        </groupBox>
                    </row>
                    <row>
                        <label id="classNameLabel" value="msg://com.haulmont.cuba.core.entity/ScheduledTask.className"
                               align="MIDDLE_LEFT"/>
                        <textField id="classNameField" datasource="taskDs" property="className" width="${fieldWidth}"
                                   required="true"/>
                        <label value=""/>
                    </row>
                    <row>
                        <label id="scriptNameLabel"
                               value="msg://com.haulmont.cuba.core.entity/ScheduledTask.scriptName" align="MIDDLE_LEFT"/>
                        <textField id="scriptNameField" datasource="taskDs" property="scriptName" width="${fieldWidth}"
                                   required="true"/>
                        <label value=""/>
                    </row>
                    <row>
                        <label value="msg://com.haulmont.cuba.core.entity/ScheduledTask.userName" align="MIDDLE_LEFT"/>
                        <lookupField id="userNameField" datasource="taskDs" property="userName" width="${fieldWidth}"/>
                        <label value=""/>
                    </row>
                    <row>
                        <label value="msg://com.haulmont.cuba.core.entity/ScheduledTask.singleton" align="MIDDLE_LEFT"/>
                        <checkBox id="singletonField" datasource="taskDs" property="singleton"/>
                        <label value=""/>
                    </row>
                    <row>
                        <label value="msg://com.haulmont.cuba.core.entity/ScheduledTask.schedulingType"
                               align="MIDDLE_LEFT"/>
                        <optionsGroup id="schedulingTypeField" datasource="taskDs" property="schedulingType"
                                      required="true" multiselect="false" orientation="horizontal"/>
                        <label value=""/>
                    </row>
                    <!--scheduling type options start-->
                    <row>
                        <label id="cronLabel" value="msg://com.haulmont.cuba.core.entity/ScheduledTask.cron"
                               align="MIDDLE_LEFT"/>
                        <hbox spacing="true">
                            <textField id="cronField" datasource="taskDs" property="cron"
                                       width="${smallFieldWidth}" required="true">
                                <validator class="com.haulmont.cuba.gui.app.core.scheduled.CronValidator"
                                           message="msg://validation.cronInvalid"/>
                            </textField>
                            <linkButton id="cronHelpButton" caption="[?]" invoke="getCronHelp" align="MIDDLE_LEFT"/>
                        </hbox>
                        <label value=""/>
                    </row>
                    <row>
                        <label id="periodLabel" value="msg://com.haulmont.cuba.core.entity/ScheduledTask.period"
                               align="MIDDLE_LEFT"/>
                        <textField id="periodField" datasource="taskDs" property="period" width="${smallFieldWidth}" required="true"/>
                        <label value=""/>
                    </row>
                    <row>
                        <label id="startDateLabel" value="msg://com.haulmont.cuba.core.entity/ScheduledTask.startDate"
                               align="MIDDLE_LEFT"/>
                        <dateField id="startDateField" datasource="taskDs" property="startDate" width="${smallFieldWidth}"/>
                        <label value=""/>
                    </row>
                    <!--scheduling type options end-->
                    <row>
                        <label value="msg://com.haulmont.cuba.core.entity/ScheduledTask.timeout"
                               align="MIDDLE_LEFT"/>
                        <textField id="timeoutField" datasource="taskDs" property="timeout" width="${smallFieldWidth}"/>
                        <label value=""/>
                    </row>
                    <row>
                        <label value="msg://com.haulmont.cuba.core.entity/ScheduledTask.timeFrame"
                               align="MIDDLE_LEFT"/>
                        <textField id="timeFrameField" datasource="taskDs" property="timeFrame" width="${smallFieldWidth}"/>
                        <label value=""/>
                    </row>
                    <row>
                        <label value="msg://com.haulmont.cuba.core.entity/ScheduledTask.permittedServers"
                               align="MIDDLE_LEFT"/>
                        <textField id="permittedServersField" datasource="taskDs" property="permittedServers"
                                   width="${fieldWidth}"/>
                        <label value=""/>
                    </row>
                    <row>
                        <label value="msg://com.haulmont.cuba.core.entity/ScheduledTask.logStart"
                               align="MIDDLE_LEFT"/>
                        <checkBox id="logStartField" datasource="taskDs" property="logStart"/>
                        <label value=""/>
                    </row>
                    <row>
                        <label value="msg://com.haulmont.cuba.core.entity/ScheduledTask.logFinish"
                               align="MIDDLE_LEFT"/>
                        <checkBox id="logFinishField" datasource="taskDs" property="logFinish"/>
                        <label value=""/>
                    </row>
                    <row>
                        <label value="msg://com.haulmont.cuba.core.entity/ScheduledTask.description"
                               align="MIDDLE_LEFT"/>
                        <textArea id="description" datasource="taskDs" property="description"
                                  width="${fieldWidth}" rows="3"/>
                        <label value=""/>
                    </row>
                </rows>
            </grid>
        </scrollBox>
        <iframe id="windowActions" src="/com/haulmont/cuba/gui/edit-window.actions.xml"/>
    </layout>
</window>