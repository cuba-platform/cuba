<window
    xmlns="http://www.haulmont.com/schema/cuba/gui/window.xsd"
    class="com.haulmont.cuba.web.app.ui.security.user.browse.UserBrowser"
    lookupComponent="users"
>
    <metadataContext>
        <deployViews name="/com/haulmont/cuba/web/app/ui/security/user/user.views.xml"/>
        <deployViews name="/com/haulmont/cuba/web/app/ui/security/group/group.views.xml"/>
    </metadataContext>

    <dsContext>
        <collectionDatasource
            id="users"
            class="com.haulmont.cuba.security.entity.User"
            view="user.browse"
        >
            <query>
                <![CDATA[
                select u
                from sec$User u
                where
                    <#if component$filter.name?has_content>u.name like :component$filter.name<#else>1=1</#if>
                    <#if component$filter.login?has_content>and u.login like :component$filter.login</#if>
                    <#if component$filter.email?has_content>and u.email = :component$filter.email</#if>
                    <#if component$filter.group?has_content>and u.group.id = :component$filter.group</#if>
                ]]>
            </query>
        </collectionDatasource>
    </dsContext>

    <layout expand="table-panel">
        <iframe id="filter" src="/com/haulmont/cuba/web/app/ui/security/user/browse/user-browse-filter.xml"/>
        <vbox id="table-panel" expand="users" spacing="true">
            <hbox>
                <button action="users.create"/>
                <button action="users.edit"/>
                <button action="users.remove"/>
                <button action="users.changePassw"/>
            </hbox>
            <table id="users" editable="false">
                <columns>
                    <column id="name" caption="msg://name"/>
                    <column id="login" caption="msg://login" clickAction="open:sec$User.edit"/>
                    <column id="email" caption="msg://email"/>
                    <column id="activeDirectoryUser" caption="msg://activeDirectoryUser"/>
                </columns>
                <rows datasource="users"/>
            </table>
        </vbox>
    </layout>
</window>
